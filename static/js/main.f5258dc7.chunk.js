(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),o=n(10),a=n.n(o),i=(n(18),n(3));function u(e){var t=e.color,n=Object(r.useMemo)(function(){return function(e){return{backgroundColor:e}}(t)},[t]);return c.a.createElement("div",{style:n})}var l=n(12),s=n(2),f=n(4);function b(e,t){return{x:e,y:t}}var v,O,d,j,p,m,h,g,y,w,E=n(11),x=n(1);function k(e){return{type:e,orientation:w.Up}}function L(e){return M[e.type][e.orientation]}!function(e){e.L="L",e.I="I",e.T="T",e.S="S",e.Z="Z",e.O="O",e.J="J"}(y||(y={})),function(e){e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left"}(w||(w={}));var R,D,M=(g={},Object(x.a)(g,y.L,(v={},Object(x.a)(v,w.Up,[[0,0,1],[1,1,1],[0,0,0]]),Object(x.a)(v,w.Right,[[0,1,0],[0,1,0],[0,1,1]]),Object(x.a)(v,w.Down,[[0,0,0],[1,1,1],[1,0,0]]),Object(x.a)(v,w.Left,[[1,1,0],[0,1,0],[0,1,0]]),v)),Object(x.a)(g,y.I,(O={},Object(x.a)(O,w.Up,[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]]),Object(x.a)(O,w.Right,[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]),Object(x.a)(O,w.Down,[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]]),Object(x.a)(O,w.Left,[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]),O)),Object(x.a)(g,y.T,(d={},Object(x.a)(d,w.Up,[[0,1,0],[1,1,1],[0,0,0]]),Object(x.a)(d,w.Right,[[0,1,0],[0,1,1],[0,1,0]]),Object(x.a)(d,w.Down,[[0,0,0],[1,1,1],[0,1,0]]),Object(x.a)(d,w.Left,[[0,1,0],[1,1,0],[0,1,0]]),d)),Object(x.a)(g,y.S,(j={},Object(x.a)(j,w.Up,[[0,1,1],[1,1,0],[0,0,0]]),Object(x.a)(j,w.Right,[[0,1,0],[0,1,1],[0,0,1]]),Object(x.a)(j,w.Down,[[0,0,0],[0,1,1],[1,1,0]]),Object(x.a)(j,w.Left,[[1,0,0],[1,1,0],[0,1,0]]),j)),Object(x.a)(g,y.Z,(p={},Object(x.a)(p,w.Up,[[1,1,0],[0,1,1],[0,0,0]]),Object(x.a)(p,w.Right,[[0,0,1],[0,1,1],[0,1,0]]),Object(x.a)(p,w.Down,[[0,0,0],[1,1,0],[0,1,1]]),Object(x.a)(p,w.Left,[[0,1,0],[1,1,0],[1,0,0]]),p)),Object(x.a)(g,y.O,(m={},Object(x.a)(m,w.Up,[[1,1],[1,1]]),Object(x.a)(m,w.Right,[[1,1],[1,1]]),Object(x.a)(m,w.Down,[[1,1],[1,1]]),Object(x.a)(m,w.Left,[[1,1],[1,1]]),m)),Object(x.a)(g,y.J,(h={},Object(x.a)(h,w.Up,[[1,0,0],[1,1,1],[0,0,0]]),Object(x.a)(h,w.Right,[[0,1,1],[0,1,0],[0,1,0]]),Object(x.a)(h,w.Down,[[0,0,0],[1,1,1],[0,0,1]]),Object(x.a)(h,w.Left,[[0,1,0],[0,1,0],[1,1,0]]),h)),g);function U(){return Object(f.shuffle)(Object.keys(y))}function C(e){var t=Object(E.a)(e),n=t[0],r=t.slice(1);return r.length>0?[n,r]:[n,U()]}function A(){var e=C(U()),t=Object(i.a)(e,2),n=t[0],r=C(t[1]),c=Object(i.a)(r,2),o=c[0],a=c[1];return{board:I(20,10),current:k(n),interval:750,level:1,next:k(o),position:b(3,0),randomizer:a,score:0,state:R.Playing}}!function(e){e[e.Playing=0]="Playing",e[e.Won=1]="Won",e[e.Lost=2]="Lost"}(R||(R={})),function(e){e.MoveDown="down",e.MoveLeft="left",e.MoveRight="right",e.Reset="reset",e.Rotate="rotate",e.Start="start",e.Stop="stop",e.Tick="tick"}(D||(D={}));var S=A();function T(e,t){switch(t){case D.Tick:case D.MoveDown:var n=function(e,t,n,r,c,o){var a=b(r.x,r.y+1);if(B(e,t,a))return[e,t,n,a,c,o];if(function(e){return 0===e.y}(r))return[e,t,n,r,c,R.Lost];var u=J(e,t,r,1);u=function(e){for(var t=e,n=!1,r=e.length/e.columns,c=0;c<r;c++)for(var o=0;o<e.columns;o++){var a=b(o,c),i=N(e,a);if(0!==_(e,i)){if(o===e.columns-1){var u;n||(n=!0,t=W(t));var s=b(0,c),v=N(e,s);t.fill.splice(v,e.columns);var O=Object(f.fill)(new Array(e.columns),0,0);(u=t.fill).unshift.apply(u,Object(l.a)(O))}}else o=Number.MAX_SAFE_INTEGER}return t}(u);var s=C(c),v=Object(i.a)(s,2),O=v[0],d=v[1],j=k(O),p=b(3,0);return[u,n,j,p,d,o]}(e.board,e.current,e.next,e.position,e.randomizer,e.state),r=Object(i.a)(n,6),c=r[0],o=r[1],a=r[2],u=r[3],v=r[4],O=r[5];return Object(s.a)({},e,{board:c,current:o,next:a,position:u,state:O,randomizer:v});case D.MoveLeft:return Object(s.a)({},e,{position:P(e.board,e.current,e.position)});case D.MoveRight:return Object(s.a)({},e,{position:z(e.board,e.current,e.position)});case D.Reset:return A();case D.Rotate:return Object(s.a)({},e,{current:Z(e.board,e.current,e.position)});case D.Start:return Object(s.a)({},e,{state:R.Playing});default:return e}}function I(e,t){var n=Object(f.fill)(new Array(e*t),0,0);return{columns:t,fill:n,length:n.length}}function J(e,t,n,r){for(var c=L(t),o=W(e),a=0;a<c.length;a++)for(var i=0;i<c[a].length;i++){if(0!==c[a][i])F(o,N(e,b(n.x+i,n.y+a)),r)}return o}function P(e,t,n){var r=b(n.x-1,n.y);return B(e,t,r)?r:n}function z(e,t,n){var r=b(n.x+1,n.y);return B(e,t,r)?r:n}function Z(e,t,n){var r=function(e){return Object(s.a)({},e,{orientation:(t=e.orientation,(t+1)%4)});var t}(t);return B(e,r,n)?r:t}function B(e,t,n){for(var r=L(t),c=e.columns-1,o=e.length/e.columns-1,a=0;a<r.length;a++)for(var i=0;i<r[a].length;i++)if(0!==r[a][i]){if(n.x+i<0||n.x+i>c)return!1;if(n.y+a<0||n.y+a>o)return!1;if(1===_(e,N(e,b(n.x+i,n.y+a))))return!1}return!0}function N(e,t){return t.x+t.y*e.columns}function W(e){return Object(s.a)({},e,{fill:e.fill.slice()})}function _(e,t){return e.fill[t]}function F(e,t,n){e.fill[t]=n}function G(e){var t=e.board,n=e.colors,o=e.current,a=e.height,i=e.position,l=e.width,s=Object(r.useMemo)(function(){return function(e,t,n){return{borderBottom:"1px solid grey",display:"grid",gridTemplateColumns:"repeat(".concat(e,", 1fr)"),height:t,width:n}}(t.columns,a,l)},[t.columns,a,l]),f=J(t,o,i,2);return c.a.createElement("div",{style:s},function(e,t){return e.fill.map(t)}(f,function(e,t){return c.a.createElement(u,{color:n[e],key:"".concat(t,"-").concat(e)})}))}function X(e){var t=e.board,n=e.children,r=e.current,o=e.position;return c.a.createElement("div",{style:q.container},c.a.createElement(G,{board:t,colors:Y,current:r,height:400,position:o,width:200}),n)}var Y={0:"black",1:"dodgerblue",2:"limegreen"},q={container:{position:"relative"}},H=I(5,5),K=b(1,1);function Q(e){var t=e.next;return c.a.createElement(G,{board:H,colors:V,current:t,height:100,position:K,width:100})}var V={0:"black",1:"dodgerblue",2:"yellow"};function $(e){var t=e.children,n=e.level,r=e.next,o=e.score;return c.a.createElement("div",null,c.a.createElement(Q,{next:r}),c.a.createElement("div",null,"Level: ",n),c.a.createElement("div",null,"Score: ",o),c.a.createElement("div",null,t))}function ee(e,t){Object(r.useEffect)(function(){function n(n){n.key===e&&t(n)}return document.addEventListener("keydown",n),function(){return document.removeEventListener("keydown",n)}},[e,t])}function te(e){var t=e.dispatch,n=e.state,o=Object(r.useCallback)(function(){return t(D.Reset)},[t]);return ee(" ",o),c.a.createElement("div",{style:ne.container},c.a.createElement(X,{board:n.board,current:n.current,position:n.position},c.a.createElement("span",{style:ne.text},"You lost!")),c.a.createElement($,{level:n.level,next:n.next,score:n.score},c.a.createElement("button",{onClick:o},"Reset")))}var ne={container:{display:"flex"},text:{backgroundColor:"whitesmoke",color:"black",display:"block",position:"absolute",textAlign:"center",top:"50%",width:"100%"}};function re(e){var t=e.dispatch,n=e.state,o=Object(r.useCallback)(function(){return t(D.Rotate)},[t]),a=Object(r.useCallback)(function(){return t(D.MoveDown)},[t]),i=Object(r.useCallback)(function(){return t(D.MoveLeft)},[t]),u=Object(r.useCallback)(function(){return t(D.MoveRight)},[t]),l=Object(r.useCallback)(function(){return t(D.Tick)},[t]);return ee("ArrowUp",o),ee("ArrowDown",a),ee("ArrowLeft",i),ee("ArrowRight",u),function(e,t){var n=Object(r.useRef)();Object(r.useEffect)(function(){n.current=t},[t]),Object(r.useEffect)(function(){var t=setInterval(function(){n.current&&n.current()},e);return function(){return clearInterval(t)}},[e,t])}(n.interval,l),c.a.createElement("div",{style:ce.container},c.a.createElement(X,{board:n.board,current:n.current,position:n.position}),c.a.createElement($,{level:n.level,next:n.next,score:n.score}))}var ce={container:{display:"flex"}};a.a.render(c.a.createElement(function(){var e=Object(r.useReducer)(T,S),t=Object(i.a)(e,2),n=t[0],o=t[1];switch(n.state){case R.Lost:return c.a.createElement(te,{dispatch:o,state:n});case R.Playing:return c.a.createElement(re,{dispatch:o,state:n});default:return null}}),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.f5258dc7.chunk.js.map